<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Resolve — Claim Flow DAG</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body, {
      delimiters: [
        {left: '$$', right: '$$', display: true},
        {left: '$', right: '$', display: false}
      ],
      throwOnError: false
    });"></script>
  <style>
:root {
  --bg: #0d1117;
  --card-bg: #161b22;
  --border: #30363d;
  --text: #e6edf3;
  --text-muted: #8b949e;
  --accent: #58a6ff;
  --green: #3fb950;
  --orange: #d29922;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
  padding: 2rem;
  max-width: 1200px;
  margin: 0 auto;
}
nav {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
  margin-bottom: 2rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid var(--border);
}
nav a {
  color: var(--accent);
  text-decoration: none;
  padding: 0.3rem 0.8rem;
  border-radius: 6px;
  border: 1px solid var(--border);
  font-size: 0.85rem;
}
nav a:hover, nav a.active {
  background: var(--accent);
  color: var(--bg);
  border-color: var(--accent);
}
h1 {
  font-size: 1.8rem;
  margin-bottom: 1.5rem;
  color: var(--text);
}
.sumcheck-card {
  background: var(--card-bg);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
}
.sumcheck-card h3 {
  font-size: 1.3rem;
  margin-bottom: 1rem;
  color: var(--accent);
}
.metadata {
  display: flex;
  gap: 1.5rem;
  flex-wrap: wrap;
  margin-bottom: 1rem;
}
.meta-item {
  font-size: 0.9rem;
}
.meta-label {
  color: var(--text-muted);
  margin-right: 0.3rem;
}
.meta-label::after { content: ":"; }
.sum-over {
  margin-bottom: 1rem;
  padding: 0.5rem 0.75rem;
  background: rgba(88, 166, 255, 0.05);
  border-left: 3px solid var(--accent);
  border-radius: 0 4px 4px 0;
}
.spec-section { margin-top: 1rem; }
.spec-section h4 {
  font-size: 0.85rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 0.5rem;
}
.math-block {
  overflow-x: auto;
  padding: 0.75rem 1rem;
  background: rgba(255,255,255,0.02);
  border-radius: 4px;
  border: 1px solid var(--border);
}
.table-wrap { overflow-x: auto; }
.constraint-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9rem;
}
.constraint-table th, .constraint-table td {
  padding: 0.4rem 0.75rem;
  border-bottom: 1px solid var(--border);
  text-align: left;
  white-space: nowrap;
}
.constraint-table th {
  color: var(--text-muted);
  font-weight: 600;
  font-size: 0.8rem;
  text-transform: uppercase;
}
.constraint-table .idx { text-align: right; color: var(--text-muted); }
.constraint-table .label { font-family: monospace; font-size: 0.8rem; }
.constraint-table .math-cell { font-size: 0.85rem; }
.openings { list-style: none; padding-left: 0; }
.openings li {
  padding: 0.2rem 0;
  font-size: 0.9rem;
}
.openings li::before {
  content: "\2192 ";
  color: var(--text-muted);
}

    .resolve-bar {
      display: flex;
      align-items: center;
      gap: 1.25rem;
      flex-wrap: wrap;
      margin-bottom: 1rem;
      padding: 0.6rem 1rem;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 0.85rem;
    }
    .legend-item { display: flex; align-items: center; gap: 0.35rem; color: var(--text-muted); }
    .legend-dot { width: 14px; height: 4px; border-radius: 2px; display: inline-block; }
    .btn-ctrl {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text);
      padding: 0.25rem 0.7rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.8rem;
    }
    .btn-ctrl:hover { border-color: var(--accent); color: var(--accent); }
    .resolve-wrap { display: flex; gap: 1rem; height: 700px; }
    #cy {
      flex: 1;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--card-bg);
    }
    #info-panel {
      width: 270px;
      flex-shrink: 0;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--card-bg);
      padding: 1rem;
      overflow-y: auto;
      font-size: 0.85rem;
    }
    #info-panel h3 { color: var(--accent); margin-bottom: 0.5rem; font-size: 1rem; }
    #info-panel .hint { color: var(--text-muted); font-size: 0.8rem; }
    .info-section { margin-top: 0.85rem; }
    .info-label {
      color: var(--text-muted);
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.3rem;
    }
    .info-poly {
      font-family: monospace;
      font-size: 0.78rem;
      padding: 0.1rem 0;
      word-break: break-all;
    }
    .info-poly.vp { color: #d29922; }
    .info-poly.cp { color: #3fb950; }
    .stage-badge {
      display: inline-block;
      padding: 0.15rem 0.5rem;
      border-radius: 4px;
      font-size: 0.72rem;
      font-weight: 600;
    }
    </style>
</head>
<body>
  <nav>
    <a href="index.html">Overview</a>
    <a href="stage1.html">Stage 1</a>
    <a href="stage2.html">Stage 2</a>
    <a href="stage3.html">Stage 3</a>
    <a href="stage4.html">Stage 4</a>
    <a href="stage5.html">Stage 5</a>
    <a href="stage6.html">Stage 6</a>
    <a href="stage7.html">Stage 7</a>
    <a href="openings.html">Openings</a>
    <a href="polynomials.html">Polynomials</a>
    <a href="resolve.html" class="active">Resolve</a>
  </nav>
  <h1>Resolve — Claim Flow DAG</h1>
  
  <div class="resolve-bar">
    <button class="btn-ctrl" id="btn-fit">Fit all</button>
    <button class="btn-ctrl" id="btn-reset">Reset</button>
    <span class="legend-item">
      <span class="legend-dot" style="background:#d29922"></span> virtual poly claim
    </span>
    <span class="legend-item">
      <span class="legend-dot" style="background:#3fb950"></span> committed → PCS
    </span>
    
  </div>
  <div class="resolve-wrap">
    <div id="cy"></div>
    <div id="info-panel">
      <h3>Claim Flow DAG</h3>
      <p class="hint">Click a node or edge to explore claim flows between sumchecks.</p>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/cytoscape@3.30.2/dist/cytoscape.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dagre@0.8.5/dist/dagre.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/cytoscape-dagre@2.5.0/cytoscape-dagre.js"></script>
  <script>
    const RESOLVE_DATA = {"nodes": [{"id": "PCS", "label": "PCS", "stage": 0, "stage_title": "PCS Verification", "is_pcs": true}, {"id": "S1_SpartanOuter (Stage 1)", "label": "SpartanOuter (Stage 1)", "stage": 1, "stage_title": "Spartan", "is_pcs": false}, {"id": "S2_SpartanProductVirtualization", "label": "SpartanProductVirtualization", "stage": 2, "stage_title": "Virtualization & RAM", "is_pcs": false}, {"id": "S2_RamReadWriteChecking", "label": "RamReadWriteChecking", "stage": 2, "stage_title": "Virtualization & RAM", "is_pcs": false}, {"id": "S2_InstructionClaimReduction", "label": "InstructionClaimReduction", "stage": 2, "stage_title": "Virtualization & RAM", "is_pcs": false}, {"id": "S2_RamRafEvaluation", "label": "RamRafEvaluation", "stage": 2, "stage_title": "Virtualization & RAM", "is_pcs": false}, {"id": "S2_RamOutputCheck", "label": "RamOutputCheck", "stage": 2, "stage_title": "Virtualization & RAM", "is_pcs": false}, {"id": "S3_Shift", "label": "Shift", "stage": 3, "stage_title": "Shift & Instruction Input", "is_pcs": false}, {"id": "S3_InstructionInput", "label": "InstructionInput", "stage": 3, "stage_title": "Shift & Instruction Input", "is_pcs": false}, {"id": "S3_RegistersClaimReduction", "label": "RegistersClaimReduction", "stage": 3, "stage_title": "Shift & Instruction Input", "is_pcs": false}, {"id": "S4_RegistersReadWriteChecking", "label": "RegistersReadWriteChecking", "stage": 4, "stage_title": "Registers & RAM Val", "is_pcs": false}, {"id": "S4_RamValCheck", "label": "RamValCheck", "stage": 4, "stage_title": "Registers & RAM Val", "is_pcs": false}, {"id": "S5_InstructionReadRaf", "label": "InstructionReadRaf", "stage": 5, "stage_title": "Instruction Read RAF & Reductions", "is_pcs": false}, {"id": "S5_RamRaClaimReduction", "label": "RamRaClaimReduction", "stage": 5, "stage_title": "Instruction Read RAF & Reductions", "is_pcs": false}, {"id": "S5_RegistersValEvaluation", "label": "RegistersValEvaluation", "stage": 5, "stage_title": "Instruction Read RAF & Reductions", "is_pcs": false}, {"id": "S6_RamHammingBooleanity", "label": "RamHammingBooleanity", "stage": 6, "stage_title": "Booleanity, Bytecode & Virtualization", "is_pcs": false}, {"id": "S6_IncClaimReduction", "label": "IncClaimReduction", "stage": 6, "stage_title": "Booleanity, Bytecode & Virtualization", "is_pcs": false}, {"id": "S6_BytecodeReadRaf", "label": "BytecodeReadRaf", "stage": 6, "stage_title": "Booleanity, Bytecode & Virtualization", "is_pcs": false}, {"id": "S6_InstructionRaVirtualization", "label": "InstructionRaVirtualization", "stage": 6, "stage_title": "Booleanity, Bytecode & Virtualization", "is_pcs": false}, {"id": "S6_RamRaVirtualization", "label": "RamRaVirtualization", "stage": 6, "stage_title": "Booleanity, Bytecode & Virtualization", "is_pcs": false}, {"id": "S6_Booleanity", "label": "Booleanity", "stage": 6, "stage_title": "Booleanity, Bytecode & Virtualization", "is_pcs": false}, {"id": "S7_HammingWeightClaimReduction", "label": "HammingWeightClaimReduction", "stage": 7, "stage_title": "Hamming Weight Claim Reduction", "is_pcs": false}], "edges": [{"id": "e0", "source": "S1_SpartanOuter (Stage 1)", "target": "S2_SpartanProductVirtualization", "poly_names": ["Product", "WriteLookupOutputToRD", "WritePCtoRD", "ShouldBranch", "ShouldJump"], "kind": "vp"}, {"id": "e1", "source": "S1_SpartanOuter (Stage 1)", "target": "S2_RamReadWriteChecking", "poly_names": ["RamReadValue", "RamWriteValue"], "kind": "vp"}, {"id": "e2", "source": "S1_SpartanOuter (Stage 1)", "target": "S2_InstructionClaimReduction", "poly_names": ["LookupOutput", "LeftLookupOperand", "RightLookupOperand"], "kind": "vp"}, {"id": "e3", "source": "S1_SpartanOuter (Stage 1)", "target": "S2_RamRafEvaluation", "poly_names": ["RamAddress"], "kind": "vp"}, {"id": "e4", "source": "S1_SpartanOuter (Stage 1)", "target": "S3_Shift", "poly_names": ["NextUnexpandedPC", "NextPC", "NextIsVirtual", "NextIsFirstInSequence"], "kind": "vp"}, {"id": "e5", "source": "S2_SpartanProductVirtualization", "target": "S3_Shift", "poly_names": ["NextIsNoop"], "kind": "vp"}, {"id": "e6", "source": "S1_SpartanOuter (Stage 1)", "target": "S3_InstructionInput", "poly_names": ["RightInstructionInput", "LeftInstructionInput"], "kind": "vp"}, {"id": "e7", "source": "S2_InstructionClaimReduction", "target": "S3_InstructionInput", "poly_names": ["RightInstructionInput", "LeftInstructionInput"], "kind": "vp"}, {"id": "e8", "source": "S1_SpartanOuter (Stage 1)", "target": "S3_RegistersClaimReduction", "poly_names": ["RdWriteValue", "Rs1Value", "Rs2Value"], "kind": "vp"}, {"id": "e9", "source": "S3_RegistersClaimReduction", "target": "S4_RegistersReadWriteChecking", "poly_names": ["RdWriteValue", "Rs1Value", "Rs2Value"], "kind": "vp"}, {"id": "e10", "source": "S2_RamReadWriteChecking", "target": "S4_RamValCheck", "poly_names": ["RamVal"], "kind": "vp"}, {"id": "e11", "source": "S2_RamOutputCheck", "target": "S4_RamValCheck", "poly_names": ["RamValFinal"], "kind": "vp"}, {"id": "e12", "source": "S2_InstructionClaimReduction", "target": "S5_InstructionReadRaf", "poly_names": ["LookupOutput", "LeftLookupOperand", "RightLookupOperand"], "kind": "vp"}, {"id": "e13", "source": "S2_RamRafEvaluation", "target": "S5_RamRaClaimReduction", "poly_names": ["RamRa"], "kind": "vp"}, {"id": "e14", "source": "S2_RamReadWriteChecking", "target": "S5_RamRaClaimReduction", "poly_names": ["RamRa"], "kind": "vp"}, {"id": "e15", "source": "S4_RamValCheck", "target": "S5_RamRaClaimReduction", "poly_names": ["RamRa"], "kind": "vp"}, {"id": "e16", "source": "S4_RegistersReadWriteChecking", "target": "S5_RegistersValEvaluation", "poly_names": ["RegistersVal"], "kind": "vp"}, {"id": "e17", "source": "S2_RamReadWriteChecking", "target": "S6_IncClaimReduction", "poly_names": ["RamInc"], "kind": "cp"}, {"id": "e18", "source": "S4_RamValCheck", "target": "S6_IncClaimReduction", "poly_names": ["RamInc"], "kind": "cp"}, {"id": "e19", "source": "S4_RegistersReadWriteChecking", "target": "S6_IncClaimReduction", "poly_names": ["RdInc"], "kind": "cp"}, {"id": "e20", "source": "S5_RegistersValEvaluation", "target": "S6_IncClaimReduction", "poly_names": ["RdInc"], "kind": "cp"}, {"id": "e21", "source": "S1_SpartanOuter (Stage 1)", "target": "S6_BytecodeReadRaf", "poly_names": ["UnexpandedPC", "Imm", "OpFlags(AddOperands)", "OpFlags(Advice)", "OpFlags(Assert)", "OpFlags(DoNotUpdateUnexpandedPC)", "OpFlags(IsCompressed)", "OpFlags(IsFirstInSequence)", "OpFlags(IsLastInSequence)", "OpFlags(Jump)", "OpFlags(Load)", "OpFlags(MultiplyOperands)", "OpFlags(Store)", "OpFlags(SubtractOperands)", "OpFlags(VirtualInstruction)", "OpFlags(WriteLookupOutputToRD)", "PC"], "kind": "vp"}, {"id": "e22", "source": "S2_SpartanProductVirtualization", "target": "S6_BytecodeReadRaf", "poly_names": ["OpFlags(Jump)", "InstructionFlags(Branch)", "InstructionFlags(IsRdNotZero)", "OpFlags(WriteLookupOutputToRD)", "OpFlags(VirtualInstruction)"], "kind": "vp"}, {"id": "e23", "source": "S3_InstructionInput", "target": "S6_BytecodeReadRaf", "poly_names": ["Imm", "UnexpandedPC", "InstructionFlags(LeftOperandIsRs1Value)", "InstructionFlags(LeftOperandIsPC)", "InstructionFlags(RightOperandIsRs2Value)", "InstructionFlags(RightOperandIsImm)"], "kind": "vp"}, {"id": "e24", "source": "S3_Shift", "target": "S6_BytecodeReadRaf", "poly_names": ["InstructionFlags(IsNoop)", "OpFlags(VirtualInstruction)", "OpFlags(IsFirstInSequence)", "PC"], "kind": "vp"}, {"id": "e25", "source": "S4_RegistersReadWriteChecking", "target": "S6_BytecodeReadRaf", "poly_names": ["RdWa", "Rs1Ra", "Rs2Ra"], "kind": "vp"}, {"id": "e26", "source": "S5_RegistersValEvaluation", "target": "S6_BytecodeReadRaf", "poly_names": ["RdWa"], "kind": "vp"}, {"id": "e27", "source": "S5_InstructionReadRaf", "target": "S6_BytecodeReadRaf", "poly_names": ["InstructionRafFlag", "TableFlag(j)"], "kind": "vp"}, {"id": "e28", "source": "S5_InstructionReadRaf", "target": "S6_InstructionRaVirtualization", "poly_names": ["InstructionRa(i)"], "kind": "vp"}, {"id": "e29", "source": "S5_RamRaClaimReduction", "target": "S6_RamRaVirtualization", "poly_names": ["RamRa"], "kind": "vp"}, {"id": "e30", "source": "S6_RamHammingBooleanity", "target": "S7_HammingWeightClaimReduction", "poly_names": ["RamHammingWeight"], "kind": "vp"}, {"id": "e31", "source": "S6_Booleanity", "target": "S7_HammingWeightClaimReduction", "poly_names": ["Ra_j"], "kind": "cp"}, {"id": "e32", "source": "S6_IncClaimReduction", "target": "PCS", "poly_names": ["RamInc", "RdInc"], "kind": "cp"}, {"id": "e33", "source": "S6_BytecodeReadRaf", "target": "PCS", "poly_names": ["BytecodeRa(i)"], "kind": "cp"}, {"id": "e34", "source": "S6_InstructionRaVirtualization", "target": "PCS", "poly_names": ["InstructionRa(j)"], "kind": "cp"}, {"id": "e35", "source": "S6_RamRaVirtualization", "target": "PCS", "poly_names": ["RamRa(i)"], "kind": "cp"}, {"id": "e36", "source": "S7_HammingWeightClaimReduction", "target": "PCS", "poly_names": ["Ra_j"], "kind": "cp"}], "unresolved": []};
    const STAGE_COLORS = {"0": "#3fb950", "1": "#1f6feb", "2": "#8957e5", "3": "#d29922", "4": "#f0883e", "5": "#56d364", "6": "#79c0ff", "7": "#ff7b72"};
    const STAGE_LABELS = {
      0: 'PCS', 1: 'Stage 1', 2: 'Stage 2', 3: 'Stage 3',
      4: 'Stage 4', 5: 'Stage 5', 6: 'Stage 6', 7: 'Stage 7'
    };

    cytoscape.use(cytoscapeDagre);

    const cyNodes = RESOLVE_DATA.nodes.map(n => ({
      data: { ...n, color: STAGE_COLORS[n.stage] || '#888' }
    }));

    const cyEdges = RESOLVE_DATA.edges.map(e => {
      const polys = e.poly_names;
      const shortLabel = polys.length <= 2
        ? polys.join(', ')
        : polys.slice(0, 2).join(', ') + ' +' + (polys.length - 2);
      return { data: { ...e, label: shortLabel } };
    });

    const cy = cytoscape({
      container: document.getElementById('cy'),
      elements: { nodes: cyNodes, edges: cyEdges },
      style: [
        {
          selector: 'node',
          style: {
            'background-color': 'data(color)',
            'label': 'data(label)',
            'text-valign': 'center',
            'text-halign': 'center',
            'padding': '10px',
            'font-size': '10px',
            'color': '#fff',
            'text-wrap': 'wrap',
            'text-max-width': '130px',
            'shape': 'round-rectangle',
            'border-width': 0,
          }
        },
        {
          selector: 'node[?is_pcs]',
          style: {
            'shape': 'ellipse',
            'font-weight': 'bold',
            'font-size': '12px',
            'padding': '18px',
          }
        },
        {
          selector: 'edge',
          style: {
            'width': 2,
            'target-arrow-shape': 'triangle',
            'curve-style': 'bezier',
            'line-color': function(ele) {
              return ele.data('kind') === 'cp' ? '#3fb950' : '#d29922';
            },
            'target-arrow-color': function(ele) {
              return ele.data('kind') === 'cp' ? '#3fb950' : '#d29922';
            },
            'label': 'data(label)',
            'font-size': '8px',
            'color': '#8b949e',
            'text-rotation': 'autorotate',
            'text-background-color': '#161b22',
            'text-background-opacity': 0.85,
            'text-background-padding': '2px',
            'text-margin-y': -8,
          }
        },
        {
          selector: '.highlighted',
          style: {
            'border-width': 3,
            'border-color': '#58a6ff',
            'line-color': '#58a6ff',
            'target-arrow-color': '#58a6ff',
            'opacity': 1,
          }
        },
        {
          selector: '.dimmed',
          style: { 'opacity': 0.15 }
        },
      ],
      layout: {
        name: 'dagre',
        rankDir: 'LR',
        nodeSep: 40,
        rankSep: 110,
        edgeSep: 8,
        fit: true,
        padding: 30,
        ranker: 'longest-path',
      }
    });

    const panel = document.getElementById('info-panel');

    function defaultPanel() {
      panel.innerHTML = '<h3>Claim Flow DAG</h3><p class="hint">Click a node or edge to explore claim flows between sumchecks.</p>';
    }

    function showNodeInfo(node) {
      const d = node.data();
      const color = d.color;
      const incoming = node.incomers('edge');
      const outgoing = node.outgoers('edge');

      let html = `<h3>${d.label}</h3>
        <span class="stage-badge" style="background:${color}22;color:${color};border:1px solid ${color}44">
          ${STAGE_LABELS[d.stage] || ''}
        </span>
        <div class="hint" style="margin-top:.4rem">${d.stage_title}</div>`;

      if (incoming.length) {
        html += `<div class="info-section"><div class="info-label">Consumes (${incoming.length} flow${incoming.length>1?'s':''})</div>`;
        incoming.forEach(e => {
          e.data('poly_names').forEach(p => {
            html += `<div class="info-poly ${e.data('kind')}">${e.data('kind')}:${p}</div>`;
          });
        });
        html += '</div>';
      }

      if (outgoing.length) {
        html += `<div class="info-section"><div class="info-label">Produces (${outgoing.length} flow${outgoing.length>1?'s':''})</div>`;
        outgoing.forEach(e => {
          const tgt = e.target().id() === 'PCS' ? ' → PCS' : '';
          e.data('poly_names').forEach(p => {
            html += `<div class="info-poly ${e.data('kind')}">${e.data('kind')}:${p}${tgt}</div>`;
          });
        });
        html += '</div>';
      }

      panel.innerHTML = html;
    }

    function showEdgeInfo(edge) {
      const d = edge.data();
      const src = edge.source().data();
      const tgt = edge.target().data();
      const kindLabel = d.kind === 'cp' ? 'Committed → PCS' : 'Virtual poly claim';
      const color = d.kind === 'cp' ? '#3fb950' : '#d29922';

      panel.innerHTML = `
        <h3 style="color:${color}">${kindLabel}</h3>
        <div class="info-section">
          <div class="info-label">From</div>
          <div>${src.label}</div>
        </div>
        <div class="info-section">
          <div class="info-label">To</div>
          <div>${tgt.label}</div>
        </div>
        <div class="info-section">
          <div class="info-label">Polynomials (${d.poly_names.length})</div>
          ${d.poly_names.map(p => `<div class="info-poly ${d.kind}">${d.kind}:${p}</div>`).join('')}
        </div>`;
    }

    cy.on('tap', 'node', evt => {
      const node = evt.target;
      const neighborhood = node.closedNeighborhood();
      cy.elements().addClass('dimmed');
      neighborhood.removeClass('dimmed').addClass('highlighted');
      node.removeClass('dimmed');
      showNodeInfo(node);
    });

    cy.on('tap', 'edge', evt => {
      const edge = evt.target;
      cy.elements().addClass('dimmed');
      edge.removeClass('dimmed').addClass('highlighted');
      edge.connectedNodes().removeClass('dimmed').addClass('highlighted');
      showEdgeInfo(edge);
    });

    cy.on('tap', evt => {
      if (evt.target === cy) {
        cy.elements().removeClass('dimmed highlighted');
        defaultPanel();
      }
    });

    document.getElementById('btn-fit').addEventListener('click', () => cy.fit(30));
    document.getElementById('btn-reset').addEventListener('click', () => {
      cy.elements().removeClass('dimmed highlighted');
      cy.fit(30);
      defaultPanel();
    });
  </script>
</body>
</html>